# مبانی معماری کامپیوتر - نمای کلی

<div dir="rtl">

## 📑 فهرست مطالب

- [سرفصل‌های درس](#سرفصل‌های-درس)
- [فلسفه درس](#فلسفه-درس)
- [لایه‌های انتزاع](#لایه‌های-انتزاع)
- [انواع کامپیوترها](#انواع-کامپیوترها)
- [دوران پساکامپیوترهای شخصی](#دوران-پساکامپیوترهای-شخصی)
- [یادگیری ماشین و سخت‌افزار](#یادگیری-ماشین-و-سخت‌افزار)

---

## سرفصل‌های درس

### 🖥️ آشنایی با اجزای اصلی سیستم کامپیوتری

این بخش مربوط به شناسایی بخش‌های مهم سخت‌افزار و نحوه تعامل آنها در اجرای برنامه‌ها است:

**اجزای کلیدی:**
- **پردازنده (CPU)**: مغز اصلی سیستم
- **حافظه (Memory)**: ذخیره‌سازی داده‌ها و دستورات
- **ورودی/خروجی (I/O)**: تعامل با دنیای خارج

**چرا مهم است؟**
> درک تعامل این اجزا به ما کمک می‌کند بفهمیم چگونه سیستم به‌صورت یکپارچه عمل می‌کند و عملکرد کلی را شکل می‌دهد.

### 🔧 طراحی مسیر داده‌ها و واحد کنترل

**مسیر داده‌ها (Datapath):**
- بخشی از پردازنده که عملیات محاسباتی انجام می‌دهد
- شامل ALU، رجیسترها، و مالتی‌پلکسرها

<div dir="ltr">

```
┌─────────────┐
│  Registers  │
└──────┬──────┘
       │
       ▼
   ┌───────┐
   │  ALU  │──► Result
   └───────┘
```

</div>

**واحد کنترل (Control Unit):**
- هدایت مسیر داده‌ها
- تعیین ترتیب اجرای دستورات
- تولید سیگنال‌های کنترلی

### ⚡ تکنیک‌های بهبود عملکرد

**بهینه‌سازی‌های کلیدی:**

<div dir="ltr">

| تکنیک | هدف | تأثیر |
|-------|------|-------|
| **Pipelining** | اجرای همزمان دستورات | 3-5x سریع‌تر |
| **Caching** | دسترسی سریع به داده | 10-100x سریع‌تر |
| **Branch Prediction** | کاهش توقف | 2-3x سریع‌تر |
| **Parallelism** | محاسبات موازی | Nx سریع‌تر |

</div>

**بهره‌وری انرژی:**
- کاهش ولتاژ و فرکانس
- خاموش کردن اجزای غیرفعال
- استفاده از معماری‌های کم‌مصرف

### 🔄 معماری چندپردازنده‌ای

**انواع موازی‌سازی:**

<div dir="ltr">

```
Single Processor:    Multi-Processor:
┌──────┐            ┌──────┬──────┬──────┐
│ CPU  │            │ CPU1 │ CPU2 │ CPU3 │
└──────┘            └──────┴──────┴──────┘
                           │
                    ┌──────▼──────┐
                    │ Shared Mem  │
                    └─────────────┘
```

</div>

**مزایا:**
- افزایش قدرت محاسباتی
- بهبود بهره‌وری
- توزیع بار کاری

---

## فلسفه درس

### 🎯 هدف اصلی

> یاد بگیریم چه عواملی عملکرد و توانایی سیستم‌های کامپیوتری را تعیین می‌کنند و چگونه معماری کامپیوتر با نرم‌افزار تعامل دارد.

### 👥 برای چه کسانی؟

#### طراحان نرم‌افزار:
- **نویسندگان کامپایلر**: بهینه‌سازی کد برای سخت‌افزار
- **طراحان سیستم‌عامل**: مدیریت منابع
- **برنامه‌نویسان پایگاه داده**: بهینه‌سازی دسترسی
- **برنامه‌نویسان کاربردی**: نوشتن کد کارآمد

#### معماران سخت‌افزار:
- درک تأثیر تصمیمات طراحی بر نرم‌افزار
- ایجاد تعادل بین عملکرد و هزینه

### 📊 عوامل مؤثر بر عملکرد/توان

<div dir="ltr">

```
Performance = f(Algorithm, Language, Architecture, Hardware)

Algorithm
    ↓
تعداد دستورات سطح بالا
    ↓
Language/Compiler/Architecture
    ↓
تعداد دستورات ماشین
    ↓
Processor & Memory
    ↓
سرعت اجرا و مصرف انرژی
```

</div>

### ✅ چرا این موارد را یاد بگیریم؟

**1. برای دانشمندان و مهندسان کامپیوتر:**
> این درس پایه‌ای‌ترین دانش برای درک عملکرد سیستم‌های کامپیوتری را ارائه می‌دهد.

**2. برای سازندگان سخت‌افزار/نرم‌افزار:**
> بهینه‌سازی عملکرد و مصرف انرژی ضروری است.

**3. برای تصمیم‌گیرندگان و مشاوران:**
> فهم تفاوت‌های سخت‌افزاری و نرم‌افزاری برای ارزیابی سیستم‌ها لازم است.

---

## لایه‌های انتزاع

### 🏗️ معماری چندلایه

<div dir="ltr">

```
┌─────────────────────────────┐
│   Applications              │ ← برنامه‌های کاربردی
├─────────────────────────────┤
│   Operating System          │ ← مدیریت منابع
├─────────────────────────────┤
│   Compiler                  │ ← ترجمه کد
├─────────────────────────────┤
│   ISA (Instruction Set)     │ ← رابط سخت‌افزار/نرم‌افزار
├─────────────────────────────┤
│   Processor & Memory        │ ← اجرای دستورات
├─────────────────────────────┤
│   I/O System                │ ← ارتباط خارجی
├─────────────────────────────┤
│   Digital Design            │ ← مدارهای منطقی
├─────────────────────────────┤
│   Circuit Design            │ ← طراحی الکترونیکی
└─────────────────────────────┘
```

</div>

### 📚 توضیح لایه‌ها

#### 1. Applications (برنامه‌های کاربردی)
- نرم‌افزارهایی که کاربران استفاده می‌کنند
- مرورگرها، بازی‌ها، نرم‌افزارهای گرافیکی

#### 2. Operating System (سیستم‌عامل)
- واسط بین سخت‌افزار و نرم‌افزار
- مدیریت حافظه، پردازنده، و I/O
- مثال: Windows، Linux، macOS

#### 3. Compiler (کامپایلر)
- ترجمه کد سطح بالا به کد ماشین
- بهینه‌سازی کد

<div dir="ltr">

```c
// High-level code (C++)
int sum = a + b;

↓ Compiler

// Assembly code
add t0, t1, t2

↓ Assembler

// Machine code
0x003100B3
```

</div>

#### 4. ISA (Instruction Set Architecture)
- مشخص‌کننده دستورات پشتیبانی‌شده
- رابط بین نرم‌افزار و سخت‌افزار
- مثال: RISC-V، x86، ARM

#### 5. Processor & Memory System
- اجرای دستورات
- مدیریت داده‌ها
- شامل کش، رم، و حافظه اصلی

#### 6. I/O System and Network
- ارتباط با دستگاه‌های خارجی
- انتقال داده در شبکه

#### 7. Digital Design
- طراحی مدارهای منطقی
- گیت‌ها، ثبات‌ها، مالتی‌پلکسرها

#### 8. Circuit Design
- طراحی مدارهای الکترونیکی
- ترانزیستورها و اجزای فیزیکی

### 🔄 تعامل لایه‌ها

**اصول کلیدی:**

1. **هماهنگی لایه‌های مختلف**
   - هر لایه با لایه‌های مجاور در تعامل است
   - تغییر در یک لایه بر سایرین تأثیر می‌گذارد

2. **تحت تأثیر نیروهای در حال تغییر**
   - پیشرفت فناوری
   - کاهش هزینه
   - افزایش عملکرد
   - بهینه‌سازی انرژی

3. **طراحی، اندازه‌گیری، و ارزیابی**
   - اندازه‌گیری عملکرد
   - ارزیابی در برابر معیارها
   - بهینه‌سازی مستمر

### 📖 رابطه با دوره‌های آموزشی

<div dir="ltr">

| دوره | موضوع |
|------|-------|
| **CENG4430** | I/O و شبکه |
| **CENG2400 & CENG3420** | معماری پردازنده |
| **ENGG2020** | مدارهای الکترونیکی |
| **CENG3470** | طراحی دیجیتال |

</div>

---

## انواع کامپیوترها

### 💻 1. کامپیوترهای دسکتاپ

**ویژگی‌ها:**
- عملکرد خوب برای یک کاربر
- هزینه پایین
- رابط گرافیکی کاربرپسند

**کاربردها:**
- امور شخصی و دفتری
- نرم‌افزارهای تولیدی
- بازی‌های رایانه‌ای

**اجزا:**
- کیبورد و ماوس
- مانیتور
- کیس پردازنده

### 🖥️ 2. سرورها

**ویژگی‌ها:**
- اجرای برنامه‌های بزرگ
- پشتیبانی از چندین کاربر همزمان
- دسترسی از طریق شبکه

**ویژگی‌های کلیدی:**

<div dir="ltr">

| ویژگی | اهمیت | توضیح |
|-------|--------|-------|
| **Dependability** | بالا | همیشه در دسترس |
| **Security** | بالا | حفاظت از داده‌ها |
| **Scalability** | متوسط | قابلیت گسترش |
| **Performance** | بالا | پاسخ‌دهی سریع |

</div>

**کاربردها:**
- پایگاه‌های داده
- وب‌سایت‌ها
- خدمات ابری
- ایمیل و فایل‌شریینگ

### 🚀 3. ابرکامپیوترها

**مشخصات:**

<div dir="ltr">

```
┌─────────────────────────────┐
│   Tianhe-2 (راه شیری-2)     │
├─────────────────────────────┤
│ Cores:    3+ million        │
│ Power:    17.6 MW           │
│           (24 MW با cooling)│
│ Speed:    33.86 PFLOPS      │
│           (10^15 ops/sec)   │
└─────────────────────────────┘
```

</div>

**ویژگی‌های کلیدی:**
- صدها تا هزاران پردازنده
- حافظه‌های ترابایتی
- ذخیره‌سازی پتابایتی
- توان مصرفی بسیار بالا

**کاربردها:**
- شبیه‌سازی آب‌وهوا
- مدل‌سازی مولکولی
- پردازش داده‌های بزرگ
- محاسبات علمی پیچیده

**مقایسه PFLOPS:**

<div dir="ltr">

```
1 PFLOPS = 10^15 operations/second

Desktop: ~0.0001 PFLOPS
Server:  ~0.01 PFLOPS
Super:   ~30+ PFLOPS
```

</div>

### 📱 4. کامپیوترهای تعبیه‌شده

**تعریف:**
> کامپیوتری که درون یک دستگاه دیگر قرار دارد و برای یک وظیفه خاص طراحی شده است.

**کاربردها:**

**در خودروها:**
- ECU (واحد کنترل موتور)
- ABS (ترمز ضد قفل)
- سیستم‌های سرگرمی
- ناوبری و GPS
- کنترل پایداری

<div dir="ltr">

```
      ┌─────────────┐
      │    Car      │
      ├─────────────┤
  ┌───┤ Engine ECU  │
  │   ├─────────────┤
  │   │ ABS System  │
  │   ├─────────────┤
  │   │ Navigation  │
  │   ├─────────────┤
  │   │ Safety Sys  │
  │   └─────────────┘
  │
  └──► 50-100 ECUs در خودروهای مدرن
```

</div>

**سایر کاربردها:**
- وسایل خانگی هوشمند
- تجهیزات پزشکی
- سیستم‌های صنعتی
- گوشی‌های هوشمند

---

## دوران پساکامپیوترهای شخصی

### 📱 دستگاه‌های شخصی موبایل (PMD)

**ویژگی‌ها:**
- باتری‌خور
- اتصال بی‌سیم
- قابل حمل

**مثال‌ها:**

<div dir="ltr">

| دستگاه | کاربرد اصلی |
|--------|-------------|
| **Smartphones** | ارتباطات، اپلیکیشن‌ها |
| **Tablets** | مصرف محتوا، نوشتن |
| **Smartwatches** | تناسب‌اندام، اطلاع‌رسانی |
| **E-readers** | خواندن کتاب |

</div>

**تأثیر:**
> این دستگاه‌ها جایگزین بسیاری از عملکردهای کامپیوترهای شخصی شده‌اند.

### 🏢 کامپیوترهای در مقیاس انبار (WSC)

**تعریف:**
> دیتاسنترهای عظیم با صدها هزار سرور

**ویژگی‌ها:**
- ارائه SaaS (نرم‌افزار به‌عنوان خدمات)
- مقیاس‌پذیری بالا
- مدیریت انرژی پیچیده

**مثال‌های معروف:**

<div dir="ltr">

```
Google:    Millions of servers
Amazon:    AWS datacenters worldwide
Microsoft: Azure cloud platform
Meta:      Facebook infrastructure
```

</div>

**معماری:**

<div dir="ltr">

```
┌──────────────────────────────┐
│   Warehouse-Scale Computer   │
├──────────────────────────────┤
│  ┌────┬────┬────┬────┬────┐  │
│  │Srv │Srv │Srv │... │Srv │  │
│  └────┴────┴────┴────┴────┘  │
│  ┌────┬────┬────┬────┬────┐  │
│  │Srv │Srv │Srv │... │Srv │  │
│  └────┴────┴────┴────┴────┘  │
│         ...                   │
│  ┌──────────────────────┐    │
│  │  Network & Storage   │    │
│  └──────────────────────┘    │
└──────────────────────────────┘
```

</div>

### 📈 رشد پردازنده‌های تعبیه‌شده

**مقایسه رشد:**

<div dir="ltr">

```
Embedded Processors Growth >> Desktop Processors

📱 Mobile: 2-3 billion/year
💻 Desktop: ~300 million/year

نسبت: ~7:1
```

</div>

**دلایل رشد:**
- کاربردهای گسترده در IoT
- دستگاه‌های همراه
- وسایل هوشمند
- سیستم‌های خودکار

**کاربردهای نوظهور:**

<div dir="ltr">

| حوزه | مثال |
|------|------|
| **IoT** | سنسورهای هوشمند |
| **Automotive** | خودروهای خودران |
| **Healthcare** | دستگاه‌های پوشیدنی |
| **Industrial** | اتوماسیون کارخانه |
| **Smart Home** | دستگاه‌های خانگی |

</div>

---

## یادگیری ماشین و سخت‌افزار

### 🧠 شبکه‌های عصبی کانولوشنی (CNN)

**کاربردها:**
- تشخیص تصویر
- پردازش ویدیو
- خودروهای خودران
- تشخیص صدا
- پردازش زبان طبیعی

**چالش اصلی: لایه کانولوشن**

<div dir="ltr">

```
Convolution Layer = Most Compute-Intensive

Input Image → Filters → Feature Maps

محاسبات: Millions of multiplications
حافظه:    Large tensor storage
```

</div>

### 📊 چالش‌های نوظهور

**1. نیاز به محاسبات سریع‌تر**

<div dir="ltr">

```
Traditional CPU:     ~100 GFLOPS
Modern GPU:         ~10 TFLOPS
Specialized AI:     ~100 TFLOPS
```

</div>

**2. افزایش دستگاه‌های پایانی با حافظه محدود**

**محدودیت‌ها:**

<div dir="ltr">

| دستگاه | حافظه | توان | چالش |
|--------|-------|------|------|
| **Camera** | <1GB | <5W | Real-time |
| **Phone** | 4-8GB | <10W | Battery |
| **Car** | 8-16GB | <50W | Reliability |
| **Drone** | <2GB | <20W | Weight |

</div>

**راه‌حل‌ها:**
- فشرده‌سازی مدل
- Quantization
- Pruning
- Knowledge Distillation

### 🚗 خودروهای خودران

**سیستم‌های AI مورد نیاز:**

<div dir="ltr">

```
┌────────────────────────┐
│  Autonomous Vehicle    │
├────────────────────────┤
│ Vision:  CNN           │
│ LIDAR:   Point Cloud   │
│ Radar:   Signal Proc   │
│ Plan:    RL/Planning   │
│ Control: Real-time     │
└────────────────────────┘

محاسبات: ~100 TOPS
توان:     ~300W
تأخیر:    <100ms
```

</div>

### 🍎 پردازنده Apple M1

**نوآوری در طراحی:**

<div dir="ltr">

```
┌──────────────────────────────┐
│      Apple M1 Chip           │
├──────────────────────────────┤
│  ┌────────────────────────┐  │
│  │   8-Core CPU           │  │
│  │   • 4 Performance      │  │
│  │   • 4 Efficiency       │  │
│  └────────────────────────┘  │
│  ┌────────────────────────┐  │
│  │   8-Core GPU           │  │
│  │   Graphics Processing  │  │
│  └────────────────────────┘  │
│  ┌────────────────────────┐  │
│  │   16-Core Neural Eng   │  │
│  │   ML Acceleration      │  │
│  │   11 TOPS              │  │
│  └────────────────────────┘  │
│  ┌────────────────────────┐  │
│  │   Unified Memory       │  │
│  │   8-16GB LPDDR4X       │  │
│  └────────────────────────┘  │
└──────────────────────────────┘
```

</div>

**مشخصات فنی:**

<div dir="ltr">

| جزء | مشخصات |
|-----|--------|
| **CPU** | 8 cores (4+4) |
| **GPU** | 8 cores |
| **Neural Engine** | 16 cores, 11 TOPS |
| **Memory** | 8-16GB unified |
| **Process** | 5nm |
| **Transistors** | 16 billion |
| **Power** | 10-20W |

</div>

**ویژگی‌های کلیدی:**

1. **Unified Memory Architecture**
   - حافظه مشترک برای CPU/GPU/Neural Engine
   - کاهش تأخیر انتقال داده
   - افزایش کارایی

2. **Neural Engine**
   - تسریع عملیات ML
   - پشتیبانی از Core ML
   - بهینه‌سازی برای CNN/RNN

3. **کارایی انرژی**
   - عملکرد بالا با مصرف کم
   - مناسب برای دستگاه‌های باتری‌خور

**مقایسه عملکرد:**

<div dir="ltr">

```
         Performance    Power
Intel:   ████████████  ████████████
M1:      ████████████  ████

نتیجه: عملکرد مشابه با 1/3 توان مصرفی
```

</div>

---

## 🎓 مباحث پایه‌ای طراحی

### 🔌 طراحی منطقی پایه

**موضوعات:**
- ساده‌سازی مدارهای منطقی
- ماشین‌های حالت محدود (FSM)
- طراحی اجزای مدار

**اجزای اصلی:**

<div dir="ltr">

```
Logic Gates → Registers → FSM → Datapath

AND, OR, NOT → D-FF, Latch → State Machine → ALU, Control
```

</div>

### 💾 پردازنده، حافظه، I/O

**معماری داخلی:**

<div dir="ltr">

```
┌────────────────────────────┐
│       Processor            │
│  ┌──────────┬──────────┐   │
│  │ Control  │ Datapath │   │
│  └──────────┴──────────┘   │
├────────────────────────────┤
│       Memory Hierarchy     │
│  Cache → RAM → Storage     │
├────────────────────────────┤
│       I/O Devices          │
│  Keyboard, Display, etc.   │
└────────────────────────────┘
```

</div>

### 📝 برنامه‌نویسی اسمبلی

**مهارت‌های کلیدی:**
- نوشتن کد اسمبلی
- اجرا و دیباگ
- کار با رجیسترها
- مدیریت حافظه

**مثال RISC-V:**

<div dir="ltr">

```assembly
# جمع دو عدد
addi t0, zero, 5    # t0 = 5
addi t1, zero, 3    # t1 = 3
add  t2, t0, t1     # t2 = t0 + t1 = 8

# ذخیره در حافظه
sw   t2, 0(sp)      # Memory[sp] = t2
```

</div>

### 💻 توسعه C/C++

**فرآیند کامپایل:**

<div dir="ltr">

```
Source Code (*.c)
    ↓
Preprocessor
    ↓
Compiler (gcc/clang)
    ↓
Assembly (*.s)
    ↓
Assembler
    ↓
Object File (*.o)
    ↓
Linker
    ↓
Executable
```

</div>

### 🐧 کار با Unix/Linux

**مهارت‌های لازم:**

<div dir="ltr">

```bash
# ایجاد و ویرایش فایل
nano program.c
vim script.sh

# کامپایل
gcc -o program program.c

# اجرا
./program

# مدیریت فایل
ls -la
mkdir project
cd project
```

</div>

---

## 💡 نکات کلیدی

### ✅ اصول طراحی

<div dir="ltr">

```
1. Abstraction: ساده‌سازی پیچیدگی
2. Modularity: تقسیم به بخش‌های کوچک
3. Hierarchy: سازماندهی لایه‌ای
4. Regularity: یکنواختی در طراحی
```

</div>

### 🎯 موفقیت در درس

**برای یادگیری بهتر:**
1. تمرکز روی یک مثال خاص
2. یادگیری اصول کلی
3. تعمیم به سایر معماری‌ها
4. آشنایی با تاریخچه

**منابع مطالعه:**
- کتاب‌های درسی
- پترسون
- مستندات آنلاین
- پروژه‌های عملی
- شبیه‌سازها

---

## 📚 خلاصه